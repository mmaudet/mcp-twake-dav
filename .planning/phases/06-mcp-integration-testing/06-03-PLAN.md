---
phase: 06-mcp-integration-testing
plan: 03
type: execute
wave: 2
depends_on: ["06-01", "06-02"]
files_modified: []
autonomous: false

must_haves:
  truths:
    - "All 9 MCP tools appear in Claude Desktop tool list"
    - "User can ask a calendar question and get a real answer from their CalDAV server"
    - "User can ask a contact question and get a real answer from their CardDAV server"
    - "Error scenarios produce helpful, actionable messages"
    - "README instructions are sufficient for setup"
  artifacts: []
  key_links: []
---

<objective>
Verify the complete MCP server works end-to-end in Claude Desktop with real CalDAV/CardDAV data.

Purpose: Integration tests (Plan 01) validate protocol contracts in-memory, but real-world validation requires testing with Claude Desktop connected to an actual CalDAV/CardDAV server. This is the final verification gate before the project is considered complete.

Output: Human verification that all 9 tools work in Claude Desktop against a real server.
</objective>

<execution_context>
@/Users/mmaudet/.claude/get-shit-done/workflows/execute-plan.md
@/Users/mmaudet/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Build project and verify startup</name>
  <files></files>
  <action>
1. Run `npm run build` to compile TypeScript
2. Run `npm test` to confirm integration tests still pass
3. Test startup with missing env vars to verify graceful error:
   ```
   node build/index.js
   ```
   Should print AI-friendly error about missing configuration.

4. Print the Claude Desktop configuration JSON that the user needs to add, with placeholder values:
   ```json
   {
     "mcpServers": {
       "twake": {
         "command": "node",
         "args": ["/Users/mmaudet/work/mcp-twake/build/index.js"],
         "env": {
           "DAV_URL": "https://YOUR_DAV_SERVER",
           "DAV_USERNAME": "YOUR_USERNAME",
           "DAV_PASSWORD": "YOUR_PASSWORD"
         }
       }
     }
   }
   ```
   Use the actual absolute path to the build output.
  </action>
  <verify>
`npm run build` exits with code 0. `npm test` exits with code 0. `node build/index.js` (without env vars) exits with non-zero and prints a helpful error message.
  </verify>
  <done>
Project builds, tests pass, and startup error handling works. Claude Desktop config JSON ready for user.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Complete MCP server with 9 tools (5 calendar + 4 contact), integration tests, README, and LICENSE. The server connects to CalDAV/CardDAV servers via basic auth and exposes tools over MCP stdio transport.</what-built>
  <how-to-verify>
1. Add the mcp-twake server configuration to your Claude Desktop config file:
   - macOS: ~/Library/Application Support/Claude/claude_desktop_config.json
   - Fill in your real DAV_URL, DAV_USERNAME, DAV_PASSWORD

2. Restart Claude Desktop (fully quit and reopen)

3. Verify tool discovery:
   - Open a new conversation
   - You should see a hammer icon indicating MCP tools are available
   - Click it to see all 9 tools listed

4. Test calendar tools:
   - Ask: "What's my next meeting?"
   - Ask: "What's on my calendar today?"
   - Ask: "Show my schedule for this week"
   - Verify responses contain real event data from your calendar

5. Test contact tools:
   - Ask: "List my contacts"
   - Ask: "Search for [a name you know exists]"
   - Verify responses contain real contact data from your address book

6. Test error handling:
   - Temporarily set an invalid password in config, restart Claude Desktop
   - Ask for calendar data â€” should see a clear authentication error
   - Restore correct password

7. Verify README:
   - Does the README accurately describe the setup process you just followed?
   - Are the troubleshooting tips helpful?
  </how-to-verify>
  <resume-signal>Type "approved" if all verifications pass, or describe any issues found.</resume-signal>
</task>

</tasks>

<verification>
1. Project builds and tests pass
2. All 9 MCP tools discoverable in Claude Desktop
3. Calendar queries return real data
4. Contact queries return real data
5. Error handling produces helpful messages
6. README documentation is accurate and complete
</verification>

<success_criteria>
- Human confirms all 9 tools work in Claude Desktop
- At least one calendar query returns real event data
- At least one contact query returns real contact data
- Error messages are actionable when credentials are wrong
- README setup instructions are sufficient
</success_criteria>

<output>
After completion, create `.planning/phases/06-mcp-integration-testing/06-03-SUMMARY.md`
</output>
